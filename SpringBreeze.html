<!DOCTYPE html>
<html>
    
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Kasper Lindmark</title>
        <meta name="description" content="Kasper Lindmark info.">
        <link rel="stylesheet" href="main.css">
    </head>
    <body>
        <ul>        
            <li><a href="index.html"><h1>Kasper Lindmark</h1></a></li>     
            <li><a href="index.html"><h3>Projects</h3></a></li>
            <li><a href="About.html"><h3>About</h3></a></li>
        </ul>
        
        <Main class ="ListMain">
            
            <div class="iframeDiv" style="width: 40%">
                <h1>SpringBreeze</h1>
                <iframe width="100%" height="435" src="https://www.youtube.com/embed/JuPM0uysg-Y" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
            
            <div>
                <h3>
                Spring Breeze
                </h3>
                Spring Breeze is a flying action game that was a school Project. Me and 11 other students made the game during my first year at Future Games.
                
                <br><br>
                
                The game was made in Unity and I developed the Camera and Charachter Controller. The flying felt really smooth in the end and i'm really proud of what we achieved.
                
                <br><br>
                
                <a href="https://drive.google.com/file/d/1iO0lmKzLnofGViXfmSM9dkKinhcBGi8Q/view?usp=sharing"><h3 style="color:skyblue">Download</h3></a>
            </div>
        </Main>
        
        <div class = "code">
             <ul>
                 Banking
                 <br>
                 <br>
                 
                This is how the bird is rotated when it turns. the flaot bankRot is calculated by getting the input amout from the horizontal axis and multiplying it with the speed of the rotation, then we subtract the amount of turning the bird should do from its current rotation. 
                 <br>
                 <br>
                Then I check if there is any turn input and make sure that the bankRot variable is correct if there is. if there isn't we reset the birds rotation to its original value over time.
            </ul>
            
                        <button type="button" class="collapsible">Turning code</button>

            <CodeSnippet>
            <p>&nbsp;void bankTurn()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; float bankRot = transform.localEulerAngles.z - (bankSpeed * behaviourManager.GetH);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (behaviourManager.GetH &gt; 0.1f || behaviourManager.GetH &lt; -0.1f)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (bankRot &gt; 180)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bankRot -= 360;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bankRot = Mathf.Clamp(bankRot, -maxBankAngle, maxBankAngle);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperSoar", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; titanicTimerTracker = 0;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; float angeDifference = AngleDifference(bankRot, 0);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!(angeDifference &lt; 1 &amp;&amp; angeDifference &gt; -1))</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (angeDifference &lt; -0.1)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bankRot -= bankResetSpeed * Time.deltaTime;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (angeDifference &gt; 0.1)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bankRot += bankResetSpeed * Time.deltaTime;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; transform.localEulerAngles = new Vector3(transform.localEulerAngles.x, transform.localEulerAngles.y, bankRot);</p>
<p>&nbsp; &nbsp; }</p>
            </CodeSnippet>
            
              <ul>
                This is the full script with movement, rotation and more
            </ul>
            <button type="button" class="collapsible">FULL SCRIPT (VERY LONG)</button>
            <CodeSnippet class="content">
            
<p>// FlyBehaviour inherits from GenericBehaviour. This class corresponds to the flying behavior.</p>
<p>public class FlyBehaviour : GenericBehaviour</p>
<p>{</p>
<p>&nbsp; &nbsp; [Tooltip("Input for dodging left")]</p>
<p>&nbsp; &nbsp; public string dodgeLeft = "Dodge Left";</p>
<p>&nbsp; &nbsp; [Tooltip("Input for dodging right")]</p>
<p>&nbsp; &nbsp; public string dodgeRight = "Dodge Right";</p>
<p>&nbsp; &nbsp; [Tooltip("Input for boost")]</p>
<p>&nbsp; &nbsp; public string boostButton = "Boost2";</p>
<p>&nbsp; &nbsp; [Tooltip("Default fly button input")]</p>
<p>&nbsp; &nbsp; public string flyButton = "Fly"; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Default fly button.</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; [Tooltip("Maximum fly speed")]</p>
<p>&nbsp; &nbsp; public float maxFlySpeed = 120.0f;</p>
<p>&nbsp; &nbsp; [Tooltip("Minimum fly speed")]</p>
<p>&nbsp; &nbsp; public float minFlySpeed = 0.1f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("How quickly the player accelerates")]</p>
<p>&nbsp; &nbsp; private float flyAcceleration = 15.0f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("How quickly the player decelerates")]</p>
<p>&nbsp; &nbsp; private float flyDeacceleration = 15.0f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Current player speed")]</p>
<p>&nbsp; &nbsp; private float flySpeed = 2.0f; // Current fly speed</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("How much flying downwards increases speed")]</p>
<p>&nbsp; &nbsp; private float downwardMultiplier = 20.0f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("How much flying upwards decreases speed")]</p>
<p>&nbsp; &nbsp; private float upwardMultiplier = 20.0f;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Lowest vertical rotation for bird")]</p>
<p>&nbsp; &nbsp; private float minRotation = -30;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Largest vertical rotation for bird")]</p>
<p>&nbsp; &nbsp; private float maxRotation = 30;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("How quickly the bird planes out it's vertical rotation")]</p>
<p>&nbsp; &nbsp; private float rotationResetSpeed = 5.0f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Vertical rotation speed")]</p>
<p>&nbsp; &nbsp; private float rotationSpeedVert = 1.5f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Horizontal rotation speed")]</p>
<p>&nbsp; &nbsp; private float rotationSpeedHoriz = 1.5f;</p>
<p>&nbsp; &nbsp; private float rotationX = 0; &nbsp; // X-axis rotation</p>
<p>&nbsp; &nbsp; private float rotationY = 0; // Y-axis rotation</p>
<p>&nbsp; &nbsp; [HideInInspector]</p>
<p>&nbsp; &nbsp; public bool outsideRestoreX = true;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private bool restoreRotationX = false; // bool to control resetting of vertical axis</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public enum playerNumber { Player1, Player2, Player3, Player4 };</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public playerNumber playerNum;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Player initial boost speed multiplier")]</p>
<p>&nbsp; &nbsp; private float boostMultiplierBase = 1.5f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Player speed boost multiplier for using additional boost charges while boosting")]</p>
<p>&nbsp; &nbsp; private float boostMultiplierIncrease = 0.25f;</p>
<p>&nbsp; &nbsp; [Tooltip("Players current boost charges")]</p>
<p>&nbsp; &nbsp; public int currentBoostCharges = 3;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Player maximum boost charges")]</p>
<p>&nbsp; &nbsp; private int maxBoostCharges = 3;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Players initial boost to speed when using first charge")]</p>
<p>&nbsp; &nbsp; private float initalBoostSpeed = 20;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Timer until a boost is recharged")]</p>
<p>&nbsp; &nbsp; public float boostRechargeTimerLimit = 1f;</p>
<p>&nbsp; &nbsp; [Tooltip("Timer for recharging of booster")]</p>
<p>&nbsp; &nbsp; private float currentBoostRechargeTimer = 0f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Player boost charges")]</p>
<p>&nbsp; &nbsp; private float maxBoostDuration = 2f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Player boost timer increase if using additional boosts while already boosting")]</p>
<p>&nbsp; &nbsp; private float boostDurationInrease = 1f;</p>
<p>&nbsp; &nbsp; private bool boosting = false;</p>
<p>&nbsp; &nbsp; private bool boostAxisInUse = false;</p>
<p>&nbsp; &nbsp; private float currentBoostDuration = 0f;</p>
<p>&nbsp; &nbsp; private float currentBoostMultiplier = 1f;</p>
<p>&nbsp; &nbsp; private float initialSpeed;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Player dodge duration")]</p>
<p>&nbsp; &nbsp; private float maxDodgeDuration = 2f;</p>
<p>&nbsp; &nbsp; [Tooltip("Players current dodge duration")]</p>
<p>&nbsp; &nbsp; private float currentDodgeDuration = 2f;</p>
<p>&nbsp; &nbsp; [Tooltip("How long it takes for dodge to recharge")]</p>
<p>&nbsp; &nbsp; public float dodgeRechargeTimerLimit = 1.5f;</p>
<p>&nbsp; &nbsp; [Tooltip("Current dodge recharge timer")]</p>
<p>&nbsp; &nbsp; private float currentDodgeRechargeTimer = 0f;</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; [Tooltip("Speed of dodge")]</p>
<p>&nbsp; &nbsp; private float dodgeSpeed = 50f;</p>
<p>&nbsp; &nbsp; private bool dodging = false;</p>
<p>&nbsp; &nbsp; private bool canDodge = true;</p>
<p>&nbsp; &nbsp; private float dodgeDirection;</p>
<p>&nbsp; &nbsp; private bool inputEnabled = false;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public bool flyingActive = true;</p>
<p>&nbsp; &nbsp; private int flyBool; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Animator variable related to flying.</p>
<p>&nbsp; &nbsp; public bool fly = false; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Boolean to determine whether or not the player activated fly mode.&nbsp;</p>
<p>&nbsp; &nbsp; private CapsuleCollider col; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Reference to the player capsule collider.</p>
<p>&nbsp; &nbsp; private bool canBoost = true;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; [Tooltip("Make sure player can't fly beneath the terrain")]</p>
<p>&nbsp; &nbsp; public bool dontGoBelowTerrain = true;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public Volume volume;</p>
<p>&nbsp; &nbsp; public VolumeProfile notFast;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public GameObject dodgeJoint;</p>
<p>&nbsp; &nbsp; public GameObject pickUpPoint;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private ThirdPersonCameraOrbitEdition cam;</p>
<p>&nbsp; &nbsp; public float bankSpeed = 1f;</p>
<p>&nbsp; &nbsp; public float maxBankAngle = 1;</p>
<p>&nbsp; &nbsp; public float bankResetSpeed = 50;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private GameManager gameMangerRef;</p>
<p>&nbsp; &nbsp; private float verticalAxis;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private PlayerAudioScript myAudioScript;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; float oldCamSpeed = 5.7f;</p>
<p>&nbsp; &nbsp; public float dodgeCamSpeed = 1.5f;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; CrashedBehaviour crashBehaviour;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private Animator owlAnimator;</p>
<p>&nbsp; &nbsp; private Animator mouseAnimator;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private float titanicTimer = 3;</p>
<p>&nbsp; &nbsp; private float titanicTimerTracker;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; float IdleTimer = 5f;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; [SerializeField]</p>
<p>&nbsp; &nbsp; float SuperIdleTimer = 5f;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; float tempTime;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Start is always called after any Awake functions.</p>
<p>&nbsp; &nbsp; void Start()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; outsideRestoreX = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; cam = Camera.main.GetComponent&lt;ThirdPersonCameraOrbitEdition&gt;();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; cam.targetIsGrounded = true;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; oldCamSpeed = behaviourManager.playerCamera.GetComponent&lt;ThirdPersonCameraOrbitEdition&gt;().chaseCamLocSpeed;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Set up the references.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; flyBool = Animator.StringToHash("isFlying");</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; col = this.GetComponent&lt;CapsuleCollider&gt;();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Subscribe this behavior on the manager.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.SubscribeBehaviour(this);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (DisplayBoostInformation.GetInstance())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DisplayBoostInformation.GetInstance().UpdateBoostCharges(currentBoostCharges);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; crashBehaviour = this.gameObject.GetComponent&lt;CrashedBehaviour&gt;();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; gameMangerRef = GameManager.GetInstance();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; //gameMangerRef.GetComponent&lt;ObjectiveManager&gt;().objectivePickUp += SetCanNotBoost;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; //gameMangerRef.GetComponent&lt;ObjectiveManager&gt;().objectiveDrop += SetCanBoost;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; initialSpeed = flySpeed;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; myAudioScript = GetComponentInChildren&lt;PlayerAudioScript&gt;();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; switch (playerNum)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case playerNumber.Player1:</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodgeLeft = "Dodge Left";</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodgeRight = "Dodge Right";</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boostButton = "Boost";</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flyButton = "Fly";</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case playerNumber.Player2:</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodgeLeft = "Dodge Left2";</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodgeRight = "Dodge Right2";</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boostButton = "Boost2";</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flyButton = "Fly2";</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case playerNumber.Player3:</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case playerNumber.Player4:</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; owlAnimator = GetComponent&lt;BaseBehaviour&gt;().GetOwlAnim;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator = GetComponent&lt;BaseBehaviour&gt;().GetMouseAnim;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public void SetCurrentRot()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; rotationY = transform.localEulerAngles.y;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; rotationX = -transform.localEulerAngles.x;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Update is used to set features regardless the active behavior.</p>
<p>&nbsp; &nbsp; void Update()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; //print(rotationX);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; SetVerticalModifier();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Toggle fly by input, only if there is no overriding state or temporary transitions.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (Input.GetButtonDown(flyButton)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; !behaviourManager.IsOverriding()</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; !behaviourManager.GetTempLockStatus(behaviourManager.GetDefaultBehaviour)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; inputEnabled</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; (!fly))</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (cam.targetIsCrashed)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cam.targetIsCrashed = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //reset rotation values when behavior is changed!</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SetCurrentRot();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fly = !fly;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Force end jump transition.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.UnlockTempBehaviour(behaviourManager.GetDefaultBehaviour);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Obey gravity. It's the law!</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.GetRigidBody.useGravity = !fly;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Player is flying.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (fly)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cam.targetIsGrounded = false;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Disable the free look camera in the air if it is toggled in the menu</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (gameMangerRef.IsOrbitCamEnabledMenu)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameMangerRef.DisableOrbitCam = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameMangerRef.DisableOrbitCam = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Set the runwalk variables back to 5 (boo don't hard-code stupid)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameMangerRef.PlayerRef.GetComponent&lt;GroundBehaviour&gt;().runSpeed = 5f;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameMangerRef.PlayerRef.GetComponent&lt;GroundBehaviour&gt;().walkSpeed = 5f;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Register this behavior.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.RegisterBehaviour(this.behaviourCode);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flySpeed = minFlySpeed;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (myAudioScript)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; myAudioScript.PlayGlidingSound();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SetCanBoost();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; canDodge = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cam.targetIsGrounded = true;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Set collider direction to vertical.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; col.direction = 1;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Set camera default offset.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.GetOrbitCamScript.ResetTargetOffsets();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Unregister this behavior and set current behavior to the default one.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.UnregisterBehaviour(this.behaviourCode);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (myAudioScript)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; myAudioScript.StopGlidingSound();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; myAudioScript.PlayInitiateLandingSound();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SetCanNotBoost();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; canDodge = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // If left trigger is pushed down use boost once</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (Input.GetAxis(boostButton) &lt; 0 &amp;&amp; inputEnabled)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!boostAxisInUse)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boostAxisInUse = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UseBoost();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Function to make left trigger behave like button</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (Input.GetAxis(boostButton) == 0 &amp;&amp; inputEnabled)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boostAxisInUse = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // &nbsp;Dodge left</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (Input.GetButtonDown(dodgeLeft) &amp;&amp; inputEnabled)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dodge(-1);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Or dodge right</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else if (Input.GetButtonDown(dodgeRight) &amp;&amp; inputEnabled)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dodge(1);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Assert this is the active behavior</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; fly = fly &amp;&amp; behaviourManager.IsCurrentBehaviour(this.behaviourCode);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Set fly related variables on the Animator Controller.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.GetOwlAnim.SetBool(flyBool, fly);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.GetMouseAnim.SetBool(flyBool, fly);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (IsBoosting())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.changedFOV = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.GetOrbitCamScript.SetFOV(behaviourManager.sprintFOV);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostDuration -= Time.deltaTime;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (currentBoostDuration &lt;= 0)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boosting = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notFast.components[3].active = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.changedFOV = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.GetOrbitCamScript.ResetFOV();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostMultiplier = 1f;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DecreaseSpeed();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (currentBoostCharges &lt; maxBoostCharges)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostRechargeTimer += Time.deltaTime;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (DisplayBoostInformation.GetInstance())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DisplayBoostInformation.GetInstance().UpdateBoostRechargePercentage(currentBoostRechargeTimer / boostRechargeTimerLimit);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (currentBoostRechargeTimer &gt;= boostRechargeTimerLimit)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostRechargeTimer = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostCharges += 1;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (DisplayBoostInformation.GetInstance())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DisplayBoostInformation.GetInstance().UpdateBoostCharges(currentBoostCharges);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DisplayBoostInformation.GetInstance().UpdateBoostRechargePercentage(currentBoostRechargeTimer / boostRechargeTimerLimit);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (IsDodging())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentDodgeDuration -= Time.deltaTime;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (currentDodgeDuration &lt;= 0)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodging = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; canDodge = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!CanDodge() &amp;&amp; !IsDodging())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentDodgeRechargeTimer += Time.deltaTime;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (currentDodgeRechargeTimer &gt;= dodgeRechargeTimerLimit)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentDodgeRechargeTimer = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; canDodge = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; owlAnimator?.SetBool("Boosting", boosting);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator?.SetBool("Boosting", boosting);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; owlAnimator?.SetBool("Dodge", dodging);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator?.SetBool("Dodge", dodging);</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // This function is called when another behavior overrides the current one.</p>
<p>&nbsp; &nbsp; public override void OnOverride()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Ensure the collider will return to vertical position when behavior is overridden.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; col.direction = 1;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public override void LocalStart()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; base.LocalStart();</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // LocalFixedUpdate overrides the virtual function of the base class.</p>
<p>&nbsp; &nbsp; public override void LocalFixedUpdate()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Call the fly manager.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; FlyManagement(behaviourManager.GetH, verticalAxis);</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private void FixedUpdate()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (!(CanDodge() &amp;&amp; !IsDodging()))</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cam.chaseCamLocSpeed *= 2;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (!fly)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RotationY();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LockedRotationX();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Deal with the player movement when flying.</p>
<p>&nbsp; &nbsp; void FlyManagement(float horizontal, float vertical)</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; bankTurn();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // If we are dodging add sideways dodge vector</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Vector3 dodgeVector = Vector3.zero;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (IsDodging())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cam.chaseCamLocSpeed = dodgeCamSpeed;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodgeVector = transform.right * dodgeSpeed * dodgeDirection * Time.deltaTime;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodgeVector.y = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cam.chaseCamLocSpeed = oldCamSpeed;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (flyingActive)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Force-based movement</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.GetRigidBody.velocity = Vector3.zero;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; float magnitude = Mathf.Clamp(behaviourManager.GetRigidBody.velocity.magnitude, 0.1f, maxFlySpeed);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.GetRigidBody.AddForce((magnitude * transform.forward + dodgeVector) * flySpeed * flySpeed * 2000 * currentBoostMultiplier);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Make sure we don't go below min speed or above max speed</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; flySpeed = Mathf.Clamp(flySpeed, minFlySpeed, maxFlySpeed);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Increase speed while going downwards</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (transform.forward.y &lt; -0.1)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flySpeed -= transform.forward.y * Time.deltaTime * downwardMultiplier;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; //Decrease it going upwards</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else if (transform.forward.y &gt; 0.1)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flySpeed -= transform.forward.y * Time.deltaTime * upwardMultiplier;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (inputEnabled || behaviourManager.IsGrounded())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // If the vertical input is zero start reseting x-rotation</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (vertical == 0)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restoreRotationX = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Otherwise let player change x-rotation (vertical)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restoreRotationX = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LockedRotationX();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Rotate Y if we have horizontal input</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (horizontal != 0)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RotationY();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //TODO: reset correctly</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Reset players vertical rotation if there is not vertical input and the x-axis rotation is not 0</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (restoreRotationX &amp;&amp; outsideRestoreX)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (rotationX &gt; 0)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rotationX -= Time.deltaTime * rotationResetSpeed;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transform.localEulerAngles = new Vector3(-rotationX, transform.localEulerAngles.y, transform.localEulerAngles.z);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (rotationX &lt; 0)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rotationX += Time.deltaTime * rotationResetSpeed;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transform.localEulerAngles = new Vector3(-rotationX, transform.localEulerAngles.y, transform.localEulerAngles.z);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (rotationX == 0)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; restoreRotationX = false;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (dontGoBelowTerrain)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Terrain height at current location for comparison</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (Terrain.activeTerrain)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; float terrainHeightWhereWeAre = Terrain.activeTerrain.SampleHeight(transform.position);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Make sure player doesn't go below terrain</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (terrainHeightWhereWeAre &gt; transform.position.y)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transform.position = new Vector3(transform.position.x, terrainHeightWhereWeAre, transform.position.z);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; //Set flap animations when looking up</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (transform.rotation.eulerAngles.x &lt; 90f || transform.rotation.eulerAngles.x &gt; 359f)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; owlAnimator.SetBool("Flap", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("Flap", false);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; owlAnimator.SetBool("Soar", true);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("Soar", true);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; titanicTimerTracker += Time.deltaTime;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (titanicTimerTracker &gt;= titanicTimer)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperSoar", true);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; titanicTimerTracker = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; owlAnimator.SetBool("Flap", true);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("Flap", true);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; owlAnimator.SetBool("Soar", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("Soar", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperSoar", false);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; titanicTimerTracker = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; //Set Idle Animations</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (Mathf.Abs(horizontal) &lt; 0.1f &amp;&amp; Mathf.Abs(vertical) &lt; 0.1f)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tempTime -= Time.deltaTime;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (tempTime &lt; SuperIdleTimer)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("Idle", true);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (tempTime &lt; 0)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperIdle", true);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tempTime = SuperIdleTimer + IdleTimer;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperIdle", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("Idle", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperIdle", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("Idle", false);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tempTime = SuperIdleTimer + IdleTimer;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public static float AngleDifference(float angle1, float angle2)</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; float diff = (angle2 - angle1 + 180) % 360 - 180;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; return diff &lt; -180 ? diff + 360 : diff;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; void bankTurn()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; float bankRot = transform.localEulerAngles.z - (bankSpeed * behaviourManager.GetH);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (behaviourManager.GetH &gt; 0.1f || behaviourManager.GetH &lt; -0.1f)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (bankRot &gt; 180)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bankRot -= 360;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bankRot = Mathf.Clamp(bankRot, -maxBankAngle, maxBankAngle);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperSoar", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; titanicTimerTracker = 0;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; float angeDifference = AngleDifference(bankRot, 0);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!(angeDifference &lt; 1 &amp;&amp; angeDifference &gt; -1))</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (angeDifference &lt; -0.1)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bankRot -= bankResetSpeed * Time.deltaTime;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (angeDifference &gt; 0.1)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bankRot += bankResetSpeed * Time.deltaTime;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; transform.localEulerAngles = new Vector3(transform.localEulerAngles.x, transform.localEulerAngles.y, bankRot);</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Clamped x-axis rotation between minRotation and maxRotation</p>
<p>&nbsp; &nbsp; void LockedRotationX()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; rotationX += verticalAxis * rotationSpeedVert;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; rotationX = Mathf.Clamp(rotationX, minRotation, maxRotation);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Vector3 temp = new Vector3(-rotationX, transform.localEulerAngles.y, transform.localEulerAngles.z);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (fly)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transform.localEulerAngles = temp;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Rotate y-axis free to allow turning</p>
<p>&nbsp; &nbsp; void RotationY()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; rotationY += behaviourManager.GetH * rotationSpeedHoriz;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Vector3 temp = new Vector3(transform.localEulerAngles.x, rotationY, transform.localEulerAngles.z);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (fly)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transform.localEulerAngles = temp;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public void SetSpeed(float speed)</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; flySpeed = speed;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public void ResetSpeed()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; flySpeed = initialSpeed;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; //Increase speed function</p>
<p>&nbsp; &nbsp; void IncreaseSpeed()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (flySpeed &lt; maxFlySpeed)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flySpeed += flyAcceleration * Time.deltaTime;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; //Decrease speed function</p>
<p>&nbsp; &nbsp; void DecreaseSpeed()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (flySpeed &gt; minFlySpeed)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flySpeed -= flyDeacceleration * Time.deltaTime;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; void UseBoost()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (CanBoost() &amp;&amp; IsBoosting())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boosting = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostMultiplier += boostMultiplierIncrease;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostDuration += boostDurationInrease;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostCharges -= 1;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (DisplayBoostInformation.GetInstance())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DisplayBoostInformation.GetInstance().UpdateBoostCharges(currentBoostCharges);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; myAudioScript.PlayBoostSound();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else if (CanBoost() &amp;&amp; !IsBoosting())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boosting = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostMultiplier = boostMultiplierBase;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostDuration = maxBoostDuration;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentBoostCharges -= 1;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flySpeed += initalBoostSpeed;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (DisplayBoostInformation.GetInstance())</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DisplayBoostInformation.GetInstance().UpdateBoostCharges(currentBoostCharges);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notFast.components[3].active = true;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (myAudioScript)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; myAudioScript.PlayBoostSound();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperSoar", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; titanicTimerTracker = 0;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Check if player is boosting.</p>
<p>&nbsp; &nbsp; public bool IsBoosting()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; return boosting;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Check if player can sprint (all behaviours must allow).</p>
<p>&nbsp; &nbsp; public bool CanBoost()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (currentBoostCharges &gt; 0 &amp;&amp; canBoost == true)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public void SetInput(bool b)</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; inputEnabled = b;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private void SetCanBoost()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; canBoost = true;</p>
<p>&nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; private void SetCanNotBoost()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; canBoost = false;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Check if player is dodging.</p>
<p>&nbsp; &nbsp; public bool IsDodging()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; return dodging;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // Check if player can sprint (all behaviours must allow).</p>
<p>&nbsp; &nbsp; public bool CanDodge()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; return canDodge;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; // If the player can dodge and currently isn't dodging set the dodge direction and dodge</p>
<p>&nbsp; &nbsp; private void Dodge(float direction)</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (CanDodge() &amp;&amp; !IsDodging() &amp;&amp; !cam.targetIsGrounded)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; float oldcamSpeed = behaviourManager.playerCamera.GetComponent&lt;ThirdPersonCameraOrbitEdition&gt;().chaseCamLocSpeed;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.playerCamera.GetComponent&lt;ThirdPersonCameraOrbitEdition&gt;().chaseCamLocSpeed *= 2;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodgeDirection = direction;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentDodgeDuration = maxDodgeDuration;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodging = true;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; StartCoroutine(DodgeRoll(direction));</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (myAudioScript)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; myAudioScript.PlayDodgeSound();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperSoar", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; titanicTimerTracker = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public void CrashLand()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; //reset rotation values when behavior is changed!</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; SetCurrentRot();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; cam.targetIsCrashed = true;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; transform.localEulerAngles = new Vector3(0, transform.localEulerAngles.y, transform.localEulerAngles.z);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // Set camera default offset.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; cam.ResetTargetOffsets();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; behaviourManager.OverrideWithBehaviour(crashBehaviour);</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; //if (crashBehaviour)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp;crashBehaviour.Crash();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (myAudioScript)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; myAudioScript.StopGlidingSound();</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; mouseAnimator.SetBool("SuperSoar", false);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; titanicTimerTracker = 0;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public void SetVerticalModifier()</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; if (gameMangerRef.isVerticalInverted)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; verticalAxis = behaviourManager.GetV * -1;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; else</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; verticalAxis = behaviourManager.GetV;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; private IEnumerator DodgeRoll(float leftOrRight)</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Quaternion targetRotation = dodgeJoint.transform.rotation;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; float path = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; float modifier = 1;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; targetRotation.z = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; targetRotation.y = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; targetRotation.x = 0;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; modifier = leftOrRight * -1;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; while (path &lt;= 360)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dodgeJoint.transform.Rotate(0, 0, 10f * modifier, Space.Self);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path += 10;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; yield return new WaitForSeconds(0.01f);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; dodgeJoint.transform.localRotation = targetRotation;</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; yield return null;</p>
<p>&nbsp; &nbsp; }</p>
<p>
  <br>
</p>
<p>&nbsp; &nbsp; public bool Fly</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; get { return fly; }</p>
<p>&nbsp; &nbsp; }</p>
<p>}</p>                    
            </CodeSnippet> 
            
        </div>
        
<script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "block") {
      content.style.display = "none";
    } else {
      content.style.display = "block";
    }
  });
}
</script>
        
</body>